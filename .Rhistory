library(Starfish)
library(Starfish)
library(devtools)
library(roxygen2)
# library(neuralnet)
setwd("D:/work/UC/starfish/starfish")
############## install rtools ###########
# writeLines('PATH="${RTOOLS40_HOME}\\usr\\bin;${PATH}"', con = "~/.Renviron")
# setwd("D:/work/UC/prad")
# chr_length=read.csv("hg19_arm_length.csv")
##### create package #####
# devtools::create("Starfish")
####### update document #########
# devtools::document()
############ load data ############
# pcawg_chrss_raw=read.csv("pcawg_chrss_cluster_sv_dispersion.csv",header = T,stringsAsFactors = F)
# load("pcawg_chrss_cluster_neural_network_without_insertion_8_round3.rda")
#
#
#
#
# usethis::use_data(pcawg_chrss_raw)
# usethis::use_data(nn_model)
# usethis::use_data(chr_length)
###################################
########### install library ##############
# usethat::use_vignette("introduction")
devtools::document()
devtools::load_all()
devtools::install()
Packages <- c("ShatterSeek","GenomeInfoDb","plyr","data.table","GenomicRanges","IRanges","MASS","ggplot2","grid","gridExtra","dplyr","ConsensusClusterPlus","factoextra","gplots","ggpubr","reshape2","cowplot","scales","patchwork","Cairo","ggforce")
lapply(Packages, library, character.only = TRUE)
library(Starfish)
?starfish_link
?starfish_fe
?starfish_feature
library(devtools)
library(roxygen2)
# library(neuralnet)
setwd("D:/work/UC/starfish/starfish")
############## install rtools ###########
# writeLines('PATH="${RTOOLS40_HOME}\\usr\\bin;${PATH}"', con = "~/.Renviron")
# setwd("D:/work/UC/prad")
# chr_length=read.csv("hg19_arm_length.csv")
##### create package #####
# devtools::create("Starfish")
####### update document #########
# devtools::document()
############ load data ############
# pcawg_chrss_raw=read.csv("pcawg_chrss_cluster_sv_dispersion.csv",header = T,stringsAsFactors = F)
# load("pcawg_chrss_cluster_neural_network_without_insertion_8_round3.rda")
#
#
#
#
# usethis::use_data(pcawg_chrss_raw)
# usethis::use_data(nn_model)
# usethis::use_data(chr_length)
###################################
########### install library ##############
# usethat::use_vignette("introduction")
devtools::document()
devtools::load_all()
devtools::install()
Packages <- c("ShatterSeek","GenomeInfoDb","plyr","data.table","GenomicRanges","IRanges","MASS","ggplot2","grid","gridExtra","dplyr","ConsensusClusterPlus","factoextra","gplots","ggpubr","reshape2","cowplot","scales","patchwork","Cairo","ggforce")
lapply(Packages, library, character.only = TRUE)
library(Starfish)
?starfish_feature
?starfish_link
?starfish_link
?starfish_feature
?starfish_sig
?starfish_plot
?starfish_all
?starfish_sig
library(devtools)
library(roxygen2)
# library(neuralnet)
setwd("D:/work/UC/Starfish/Starfish")
############## install rtools ###########
# writeLines('PATH="${RTOOLS40_HOME}\\usr\\bin;${PATH}"', con = "~/.Renviron")
# setwd("D:/work/UC/pcawg")
# hg19_chr_length=read.csv("hg19_chr_arm_length.csv")
# hg38_chr_length=read.csv("hg38_chr_arm_length.csv")
# setwd("D:/work/UC/Starfish/Starfish")
# usethis::use_data(hg19_chr_length)
# usethis::use_data(hg38_chr_length)
# setwd("D:/work/UC/pcawg")
# example_sv=read.csv("pcawg_all_brk_insl_hom_split.csv",header = T,stringsAsFactors = F)
# example_cnv=read.csv("pcawg_neighbor_merging_cnv_gender_wgd.csv",header = T,stringsAsFactors = F)
# example_sample=read.csv("starfish_example_plot.csv",header = T,stringsAsFactors = F)
# example_sample=example_sample[example_sample$select=="yes",]
#
#
# example_sv=example_sv[example_sv$sample %in% example_sample$sample,]
# example_sv$svtype=example_sv$sv
# example_cnv=example_cnv[example_cnv$sample %in% example_sample$sample,]
# example_sv=unique(example_sv[c("chrom1","end1","chrom2","end2","strand1","strand2","svtype","sample")])
# colnames(example_sv)=c("chrom1","pos1","chrom2","pos2","strand1","strand2","svtype","sample")
# example_cnv=unique(example_cnv[c("chromosome","start","end","total_cn","sample")])
# example_sample=example_sample[c("sample","gender")]
#
# setwd("D:/work/UC/Starfish/test")
# write.csv(example_sv,"example_sv.csv",row.names = F)
# write.csv(example_cnv,"example_cnv.csv",row.names = F)
# write.csv(example_sample,"example_sample.csv",row.names = F)
#
#
# setwd("D:/work/UC/Starfish/Starfish")
#
# usethis::use_data(example_sv)
# usethis::use_data(example_cnv)
# usethis::use_data(example_sample)
##### create package #####
# devtools::create("Starfish")
####### update document #########
############ load data ############
# pcawg_chrss_raw=read.csv("pcawg_chrss_cluster_sv_dispersion.csv",header = T,stringsAsFactors = F)
# load("pcawg_chrss_cluster_neural_network_without_insertion_8_round3.rda")
#
#
#
#
# usethis::use_data(pcawg_chrss_raw)
# usethis::use_data(nn_model)
# usethis::use_data(chr_length)
###################################
########### install library ##############
devtools::document()
devtools::load_all()
devtools::install()
setwd("D:/work/UC/Starfish/test")
Packages <- c("ShatterSeek","GenomeInfoDb","plyr","data.table","GenomicRanges","IRanges","MASS","ggplot2","grid","gridExtra","dplyr","ConsensusClusterPlus","factoextra","gplots","ggpubr","reshape2","cowplot","scales","patchwork","Cairo","ggforce")
lapply(Packages, library, character.only = TRUE)
library(Starfish)
starfish_link_out=starfish_link(example_sv, prefix = "example")
library(devtools)
library(roxygen2)
# library(neuralnet)
setwd("D:/work/UC/Starfish/Starfish")
############## install rtools ###########
# writeLines('PATH="${RTOOLS40_HOME}\\usr\\bin;${PATH}"', con = "~/.Renviron")
# setwd("D:/work/UC/pcawg")
# hg19_chr_length=read.csv("hg19_chr_arm_length.csv")
# hg38_chr_length=read.csv("hg38_chr_arm_length.csv")
# setwd("D:/work/UC/Starfish/Starfish")
# usethis::use_data(hg19_chr_length)
# usethis::use_data(hg38_chr_length)
# setwd("D:/work/UC/pcawg")
# example_sv=read.csv("pcawg_all_brk_insl_hom_split.csv",header = T,stringsAsFactors = F)
# example_cnv=read.csv("pcawg_neighbor_merging_cnv_gender_wgd.csv",header = T,stringsAsFactors = F)
# example_sample=read.csv("starfish_example_plot.csv",header = T,stringsAsFactors = F)
# example_sample=example_sample[example_sample$select=="yes",]
#
#
# example_sv=example_sv[example_sv$sample %in% example_sample$sample,]
# example_sv$svtype=example_sv$sv
# example_cnv=example_cnv[example_cnv$sample %in% example_sample$sample,]
# example_sv=unique(example_sv[c("chrom1","end1","chrom2","end2","strand1","strand2","svtype","sample")])
# colnames(example_sv)=c("chrom1","pos1","chrom2","pos2","strand1","strand2","svtype","sample")
# example_cnv=unique(example_cnv[c("chromosome","start","end","total_cn","sample")])
# example_sample=example_sample[c("sample","gender")]
#
# setwd("D:/work/UC/Starfish/test")
# write.csv(example_sv,"example_sv.csv",row.names = F)
# write.csv(example_cnv,"example_cnv.csv",row.names = F)
# write.csv(example_sample,"example_sample.csv",row.names = F)
#
#
# setwd("D:/work/UC/Starfish/Starfish")
#
# usethis::use_data(example_sv)
# usethis::use_data(example_cnv)
# usethis::use_data(example_sample)
##### create package #####
# devtools::create("Starfish")
####### update document #########
############ load data ############
# pcawg_chrss_raw=read.csv("pcawg_chrss_cluster_sv_dispersion.csv",header = T,stringsAsFactors = F)
# load("pcawg_chrss_cluster_neural_network_without_insertion_8_round3.rda")
#
#
#
#
# usethis::use_data(pcawg_chrss_raw)
# usethis::use_data(nn_model)
# usethis::use_data(chr_length)
###################################
########### install library ##############
devtools::document()
devtools::load_all()
devtools::install()
setwd("D:/work/UC/Starfish/test")
Packages <- c("ShatterSeek","GenomeInfoDb","plyr","data.table","GenomicRanges","IRanges","MASS","ggplot2","grid","gridExtra","dplyr","ConsensusClusterPlus","factoextra","gplots","ggpubr","reshape2","cowplot","scales","patchwork","Cairo","ggforce")
lapply(Packages, library, character.only = TRUE)
library(Starfish)
starfish_link_out=starfish_link(example_sv, prefix = "example")
starfish_feature_out=starfish_feature(starfish_link_out$starfish_call,starfish_link_out$interleave_tra_complex_sv,example_cnv,example_sample,prefix = "example",genome_v="hg19",cnv_factor="auto",arm_del_rm=TRUE)
head(example_sample)
example_sample$gender="un"
starfish_feature_out=starfish_feature(starfish_link_out$starfish_call,starfish_link_out$interleave_tra_complex_sv,example_cnv,example_sample,prefix = "example",genome_v="hg19",cnv_factor="auto",arm_del_rm=TRUE)
example_cnv[example_cnv$sample=="c00de7a0-0b09-4e07-988c-ef2a7f8e932a_5_13"&example_cnv$chromosome=="X",]
Packages <- c("ShatterSeek","GenomeInfoDb","plyr","data.table","GenomicRanges","IRanges","MASS","ggplot2","grid","gridExtra","dplyr","ConsensusClusterPlus","factoextra","gplots","ggpubr","reshape2","cowplot","scales","patchwork","BSgenome.Hsapiens.UCSC.hg19","Cairo","ggforce")
lapply(Packages, library, character.only = TRUE)
library(Starfish)
setwd("D:/work/UC/Starfish/benchmarking/2015_micronuclei")
sv_total=read.csv("2015_micronuclei_all_sv.csv",header=T,stringsAsFactors = F)
cnv_total=read.csv("2015_micronuclei_cnv_1mb.csv",header=T,stringsAsFactors = F)
sample=read.csv("2015_micronuclei_sample.csv",header=T,stringsAsFactors = F)
# sv_total_link=starfish_link(sv_total,"2015_micronuclei")
# feature_total=starfish_feature(sv_total_link$starfish_call,sv_total_link$interleave_tra_complex_sv,cnv_total,sample,"2015_micronuclei")
# sig_total=starfish_sig(feature_total$cluster_feature,"2015_micronuclei")
starfish_output=starfish_all(sv_total,cnv_total,sample,"2015_micronuclei",arm_del_rm=FALSE)
#####################
setwd("D:/work/UC/Starfish/benchmarking/2015_chromatin_bridge")
sv_total=read.csv("2015chromatin_all_sv.csv",header=T,stringsAsFactors = F)
cnv_total=read.csv("2015_chromatin_cnv_total.csv",header=T,stringsAsFactors = F)
sample=read.csv("2015chromatin_sample.csv",header=T,stringsAsFactors = F)
starfish_output=starfish_all(sv_total,cnv_total,sample,"2015_chromatin_bridge",arm_del_rm=FALSE)
##################
setwd("D:/work/UC/Starfish/benchmarking/2020_micronuclei_chengzhong")
sv_total=read.csv("2020_micronuclei_sv_total.csv",header=T,stringsAsFactors = F)
cnv_total=read.csv("2020_micronuclei_paper_merge_cnv.csv",header=T,stringsAsFactors = F)
sample=read.csv("2020_micronuclei_sample.csv",header=T,stringsAsFactors = F)
starfish_output=starfish_all(sv_total,cnv_total,sample,"2020_micronuclei",arm_del_rm=FALSE)
##############
setwd("D:/work/UC/Starfish/benchmarking/2020_chromatin_bridge_chengzhong")
sv_total=read.csv("2020_chengzhong_bridge_sv.csv",header=T,stringsAsFactors = F)
cnv_total=read.csv("2020_chengzhong_bridge_cnv_total_seg.csv",header=T,stringsAsFactors = F)
sample=read.csv("2020_chengzhong_bridge_sample.csv",header=T,stringsAsFactors = F)
starfish_output=starfish_all(sv_total,cnv_total,sample,"2020_chromatin_bridge",arm_del_rm=FALSE)
setwd("D:/work/UC/Starfish/benchmarking/2015_chromatin_bridge")
sv_total=read.csv("2015chromatin_all_sv.csv",header=T,stringsAsFactors = F)
cnv_total=read.csv("2015_chromatin_cnv_total.csv",header=T,stringsAsFactors = F)
sample=read.csv("2015chromatin_sample.csv",header=T,stringsAsFactors = F)
starfish_output=starfish_all(sv_total,cnv_total,sample,"2015_chromatin_bridge",arm_del_rm=FALSE)
library(devtools)
library(roxygen2)
# library(neuralnet)
setwd("D:/work/UC/Starfish/Starfish")
############## install rtools ###########
# writeLines('PATH="${RTOOLS40_HOME}\\usr\\bin;${PATH}"', con = "~/.Renviron")
# setwd("D:/work/UC/pcawg")
# hg19_chr_length=read.csv("hg19_chr_arm_length.csv")
# hg38_chr_length=read.csv("hg38_chr_arm_length.csv")
# setwd("D:/work/UC/Starfish/Starfish")
# usethis::use_data(hg19_chr_length)
# usethis::use_data(hg38_chr_length)
# setwd("D:/work/UC/pcawg")
# example_sv=read.csv("pcawg_all_brk_insl_hom_split.csv",header = T,stringsAsFactors = F)
# example_cnv=read.csv("pcawg_neighbor_merging_cnv_gender_wgd.csv",header = T,stringsAsFactors = F)
# example_sample=read.csv("starfish_example_plot.csv",header = T,stringsAsFactors = F)
# example_sample=example_sample[example_sample$select=="yes",]
#
#
# example_sv=example_sv[example_sv$sample %in% example_sample$sample,]
# example_sv$svtype=example_sv$sv
# example_cnv=example_cnv[example_cnv$sample %in% example_sample$sample,]
# example_sv=unique(example_sv[c("chrom1","end1","chrom2","end2","strand1","strand2","svtype","sample")])
# colnames(example_sv)=c("chrom1","pos1","chrom2","pos2","strand1","strand2","svtype","sample")
# example_cnv=unique(example_cnv[c("chromosome","start","end","total_cn","sample")])
# example_sample=example_sample[c("sample","gender")]
#
# setwd("D:/work/UC/Starfish/test")
# write.csv(example_sv,"example_sv.csv",row.names = F)
# write.csv(example_cnv,"example_cnv.csv",row.names = F)
# write.csv(example_sample,"example_sample.csv",row.names = F)
#
#
# setwd("D:/work/UC/Starfish/Starfish")
#
# usethis::use_data(example_sv)
# usethis::use_data(example_cnv)
# usethis::use_data(example_sample)
##### create package #####
# devtools::create("Starfish")
####### update document #########
############ load data ############
# pcawg_chrss_raw=read.csv("pcawg_chrss_cluster_sv_dispersion.csv",header = T,stringsAsFactors = F)
# load("pcawg_chrss_cluster_neural_network_without_insertion_8_round3.rda")
#
#
#
#
# usethis::use_data(pcawg_chrss_raw)
# usethis::use_data(nn_model)
# usethis::use_data(chr_length)
###################################
########### install library ##############
devtools::document()
devtools::load_all()
devtools::install()
